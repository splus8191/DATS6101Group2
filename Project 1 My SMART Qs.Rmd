---
title: "Final editing to merge"
output: html_document
date: "2025-10-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
## Read...
```{r}
spotify = read.csv("spotify_churn_dataset.csv", header = TRUE)
```

## Converting character to categorical

let's convert `gender`, `country`, `subscription_type`, `device_type`, and `is_churned` to categories
```{r}
spotify$is_churned = factor(spotify$is_churned, levels = c(0, 1), labels = c("active", "churned"))
spotify$gender = as.factor(spotify$gender)
spotify$country = as.factor(spotify$country)
spotify$subscription_type = as.factor(spotify$subscription_type)
spotify$device_type = as.factor(spotify$device_type)
```

## Target balance (is_churned)
We need to know if churn is rare or common.

```{r}
tbl = table(spotify$is_churned)
tbl
round(100 * prop.table(tbl), 2)
```

```{r}
barplot(tbl,
        main = "Churn balance",
        ylab = "Count",
        col = c("gray80","gray40"))
```


# SMART Question X: Do users who skip more songs tend to churn more than users who skip less?

## EDA for that spotifyecific question**

```{r}
library(ggplot2)
ggplot(spotify, aes(x = is_churned, y = skip_rate)) +
  geom_boxplot() +
  labs(title = "Skip rate by churn group", x = "Churn group", y = "Skip rate")
```

```{r}
table(spotify$is_churned)
tapply(spotify$skip_rate, spotify$is_churned, mean)
tapply(spotify$skip_rate, spotify$is_churned, sd)
```
Churned users show a slightly higher skip rate, but the difference looks small.

## Do churned users skip more? (One-sided Welch t-test)

**H₀:** μ_churned − μ_active ≤ 0  
**H₁:** μ_churned − μ_active > 0

```{r}
t.test(
  skip_rate ~ is_churned,
  data = spotify,
  alternative = "greater",
  var.equal = FALSE
)

```
At α = 0.05: Fail to reject H₀ — the evidence is not sufficient to conclude churned users have a higher mean skip rate.



# SMART Question X: Do different subscription types (Free, Premium, Family, Student) influence users’ skip rates on spotifyotify?

## ANOVA compare means across 3+ groups (quantitative ~ categorical)

Quick visuals + group summaries (EDA before ANOVA)

```{r}

ggplot(spotify, aes(x = subscription_type, y = skip_rate)) +
  geom_boxplot() +
  coord_flip() +
  labs(title = "Skip rate by subscription type", x = NULL, y = "Skip rate")

tapply(spotify$skip_rate, spotify$subscription_type, mean)
tapply(spotify$skip_rate, spotify$subscription_type, sd)
table(spotify$subscription_type)
```
Mean skip_rate was very similar across subscription types (Family 0.300, Free 0.301, Premium 0.297, Student 0.303).

```{r}
# Fit once so we can get residuals
fit = aov(skip_rate ~ subscription_type, data = spotify)

# Q–Q plot of residuals
qqnorm(residuals(fit)); qqline(residuals(fit))

# variance check
bartlett.test(skip_rate ~ subscription_type, data = spotify)
```

```{r}
summary(fit)
```
One-way ANOVA: F(3, 7996) = 0.48, p = 0.70; we fail to reject equal means at α = 0.05. Any observed differences are small and not statistically detectable in this sample.