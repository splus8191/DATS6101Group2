---
title: "Project 1 Spotify Churn Data Science Laura Escher"
author: "Laura Escher"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(results="markup", warning = F, message = F)
options(scientific=T, digits = 3) 
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r - Investigating the data set variables}
library(ggplot2)
library(dplyr)

spotify <- read.csv("C:/Users/esche/OneDrive - The George Washington University/Intro to Data Science/Data Science Project 1/spotify_churn_dataset.csv")

str(spotify)

colSums(is.na(spotify))

nrow(spotify)

#sum(spotify$gender=='Male')
```
I first opened up the file and examined the data using the str() function. I checked to see if there are any missing values in the data, which there are none. There are 8000 observations in this data set, and 12 variables. The variables are:

Variable  |  Definition

user_id | Unique identifier for each user
gender | User gender (Male/Female/Other)
age | User age
country | User location
subscription_type | Type of Spotify subscription (Free, Premium, Family, Student)
listening_time | Minutes spent listening per day
songs_played_per_day | Number of songs played daily
skip_rate | Percentage of songs skipped
device_type | Device used (Mobile, Desktop, Web)
ads_listened_per_week | Number of ads heard per week
offline_listening | Offline mode usage (indicator variable. 0 for no offline mode usage, 1 for offline mode usage)
is_churned (indicator variable. 0 for no churn, 1 for churn)

The SMART question that I would like to consider is, "Do free users churn at a higher rate compared to premium, family, or student users?" To accomplish this goal, I will perform EDA on this portion of the data.

#EDA for Subscription Type
```{r}
spotify$subscription_type <- as.factor(spotify$subscription_type)
summary(spotify$subscription_type)
```
```{r}
spotify %>%
  group_by(subscription_type) %>%
  summarise(
    n=n(),
    mean_churn = mean(is_churned)*100)
```
Here, I create subscription type as a factor variable so I can count how many of each type of subscription are in the data set. The highest subscription type is Premium, followed by Free, Student, and Family with the lowest. The chart helps us clearly see the number of users in each subscription type and their mean churn rate (in percentage terms).

Since we want to compare free users against the other types, let's subset the data to compare. We am interested to see how they compare with their confidence intervals and a boxplot.

```{r}
free.spotify <- subset(spotify, spotify$subscription_type=="Free")
othersubs <- subset(spotify, spotify$subscription_type!="Free")
```

```{r}
t.test(free.spotify$is_churned, conf.level = 0.99)
t.test(othersubs$is_churned, conf.level = 0.99)
```

After examining the confidence intervals at standard significance levels, we do not see a statistically significant difference between free users versus other types of users on whether a given user would churn. Let's make a comparison across all the groups to highlight how they are not statistically different from one another.

```{r}
ggplot(spotify, aes(x = subscription_type, y = is_churned, fill = subscription_type)) +
  stat_summary(fun = mean, geom = "bar", width = 0.6) +
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2, conf.int = 0.99) +
  labs(
    x = "Subscription Type",
    y = "Mean Churn Rate",
    title = "Churn Rate by Subscription Type"
  ) +
  theme_minimal()
```
What level of significance would it take to show a statistically similar difference among user type?

```{r}
t.test(free.spotify$is_churned, conf.level = 0.55)
t.test(othersubs$is_churned, conf.level = 0.55)
```